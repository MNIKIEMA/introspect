(()=>{"use strict";let t=(t,e)=>{if("http"!==t&&"ws"!==t)throw Error("Protocol not supported");return""!==e?"ws"===t?"".concat("http://localhost".replace("http","ws"),"/").concat(e):"".concat("http://localhost","/").concat(e):"".concat("http://localhost")};async function e(e,o,a){let r=await fetch(t("http","upload_file_as_db"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e,file_name:o,base64_content:a})});if(!r.ok)throw Error("Failed to upload file - are you sure your network is working?");let n=await r.json();return{dbName:n.db_name,dbInfo:n.db_info}}self.onmessage=async t=>{let{type:o,token:a,fileName:r,fileBuffer:n}=t.data;if(console.log("Worker event",t.data),"UPLOAD_FILE"===o)try{let t=function(t){let e="",o=new Uint8Array(t),a=o.byteLength;for(let t=0;t<a;t++)e+=String.fromCharCode(o[t]);return self.btoa(e)}(n),{dbName:o,dbInfo:s}=await e(a,r,t);self.postMessage({type:"UPLOAD_SUCCESS",dbName:o,dbInfo:s})}catch(e){let t={type:"UPLOAD_ERROR",error:e instanceof Error?e.message:String(e)};self.postMessage(t)}}})(),_N_E={};