(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[720],{13831:function(e,t,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/log-in",function(){return o(85590)}])},31143:function(e,t,o){"use strict";var n=o(28598),s=o(1887),a=o.n(s);t.Z=()=>(0,n.jsxs)(a(),{children:[(0,n.jsx)("title",{children:"Defog.ai - AI Assistant for Data Analysis"}),(0,n.jsx)("meta",{name:"description",content:"Train your AI data assistant on your own device"}),(0,n.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,n.jsx)("link",{rel:"icon",href:"/favicon.ico"})]})},62429:function(e,t,o){"use strict";var n=o(28598),s=o(82684),a=o(91568),l=o(79869),i=o(34376);t.Z=e=>{let{id:t,userType:o,children:r}=e,{Content:c,Sider:u}=l.Layout,[d,g]=(0,s.useState)([]),[h,f]=(0,s.useContext)(a._),m=(0,i.useRouter)(),redirect=e=>{m.push(e)},logout=()=>{localStorage.removeItem("defogUser"),localStorage.removeItem("defogToken"),localStorage.removeItem("defogUserType"),f({user:null,token:null,userType:null}),redirect("/log-in")};return(0,s.useEffect)(()=>{g("admin"==o?[{key:"manage-database",title:"Manage Database",icon:(0,n.jsx)("a",{onClick:()=>redirect("/extract-metadata"),children:"\uD83D\uDCBE Manage DB"})},{key:"manage-users",title:"Manage Users",icon:(0,n.jsx)("a",{onClick:()=>redirect("/manage-users"),children:"\uD83D\uDD10 Manage Users"})},{key:"view-notebooks",title:"View your notebook",icon:(0,n.jsx)("a",{onClick:()=>redirect("/view-notebooks"),children:"\uD83D\uDCD2 Your Notebooks"})},{key:"logout",title:"Logout",icon:(0,n.jsx)("a",{onClick:logout,children:"â†ª Logout"})}]:o?[{key:"view-notebooks",title:"View your notebook",icon:(0,n.jsx)("a",{onClick:()=>redirect("/view-notebooks"),children:"Your Notebooks"})},{key:"logout",title:"Logout",icon:(0,n.jsx)("a",{onClick:logout,children:"Logout"})}]:[])},[o]),(0,n.jsx)(l.Layout,{style:{height:"100vh"},children:(0,n.jsxs)(c,{children:[d.length?(0,n.jsx)(u,{style:{height:"100vh",position:"fixed"},children:(0,n.jsx)(l.v2,{style:{width:200,paddingTop:"2em",paddingBottom:"2em"},mode:"inline",selectedKeys:[t],items:d})}):(0,n.jsx)(n.Fragment,{}),(0,n.jsx)("div",{style:{paddingLeft:240,paddingTop:30,backgroundColor:"#f5f5f5"},children:r})]})})}},85590:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return log_in}});var n=o(28598),s=o(82684),a=o(34376),l=o(31143),i=o(62429),r=o(91568),c=o(33612),u=o(85439),d=o(20259),g=o.n(d),h=o(79204),common_SSOButton=e=>{let{msalInstance:t}=e,[o,l]=(0,s.useState)(!1),i=(0,a.useRouter)(),[c,u]=(0,s.useContext)(r._),handleLogin=async()=>{if(!o){l(!0);try{let e=await t.loginPopup({scopes:["user.read"]}),o=null==e?void 0:e.idToken;console.log("Login successful!");let n=(0,h.Z)("http","validate_ms_sso"),s=await fetch(n,{method:"POST",body:JSON.stringify({token:o}),headers:{"Content-Type":"application/json"}}),a=await s.json();l(!1),"success"===a.status&&(u({user:a.user,token:a.token,userType:a.user_type}),localStorage.setItem("defogUser",a.user),localStorage.setItem("defogToken",a.token),localStorage.setItem("defogUserType",a.user_type),i.push("/"))}catch(e){console.error(e)}l(!1)}};return(0,n.jsx)("button",{onClick:handleLogin,children:"Sign In with Microsoft"})},f=o(65512),log_in=()=>{let[e,t]=(0,s.useContext)(r._),[o,d]=(0,s.useState)(null),m=(0,a.useRouter)();(0,s.useEffect)(()=>{!async function(){let e=await f.L.createPublicClientApplication({auth:{clientId:"".concat("08d036ea-f4fa-4636-b32b-3196bac0bfe7"),authority:"https://login.microsoftonline.com/".concat("91477b80-6e9d-4a55-bce4-8c2e49d1870f"),redirectUri:"".concat("http://localhost:1234/msal_redirect")}});d(e)}()},[]);let handleLogin=async e=>{let o=(0,h.Z)("http","login"),n=await fetch(o,{method:"POST",body:JSON.stringify(e)}),s=await n.json();"success"===s.status&&(t({user:e.username,token:s.token,userType:s.user_type}),localStorage.setItem("defogUser",e.username),localStorage.setItem("defogToken",s.token),localStorage.setItem("defogUserType",s.user_type),m.push("/"))};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.Z,{}),(0,n.jsxs)(i.Z,{children:[(0,n.jsx)("h1",{style:{paddingBottom:"1em"},children:"Welcome to Defog!"}),(0,n.jsxs)(u.default,{labelCol:{span:4},wrapperCol:{span:20},style:{maxWidth:800},onFinish:handleLogin,children:[(0,n.jsx)(u.default.Item,{label:"Username",name:"username",children:(0,n.jsx)(c.default,{})}),(0,n.jsx)(u.default.Item,{label:"Password",name:"password",children:(0,n.jsx)(c.default.Password,{})}),(0,n.jsx)(u.default.Item,{children:(0,n.jsx)(g(),{type:"primary",htmlType:"submit",children:"Log In"})})]}),o?(0,n.jsx)(common_SSOButton,{msalInstance:o}):null]})]})}},79204:function(e,t,o){"use strict";var n=o(20279);t.Z=(e,t)=>{if("http"!==e&&"ws"!==e)throw Error("Protocol not supported");return console.log("process.env.NEXT_PUBLIC_AGENTS_ENDPOINT","DEFOGHOSTNAME"),console.log("process.env.NEXT_PUBLIC_API_KEY",n.env.NEXT_PUBLIC_API_KEYNDPOINT),console.log("process.env.NEXT_PUBLIC_MSAL_CLIENT_ID","08d036ea-f4fa-4636-b32b-3196bac0bfe7"),console.log("process.env.NEXT_PUBLIC_MSAL_TENANT_ID","91477b80-6e9d-4a55-bce4-8c2e49d1870f"),console.log("process.env.NEXT_PUBLIC_MSAL_REDIRECT_URI","http://localhost:1234/msal_redirect"),""!==t?"".concat(e,"://").concat("DEFOGHOSTNAME","/").concat(t):"".concat(e,"://").concat("DEFOGHOSTNAME")}}},function(e){e.O(0,[456,128,512,774,888,179],function(){return e(e.s=13831)}),_N_E=e.O()}]);