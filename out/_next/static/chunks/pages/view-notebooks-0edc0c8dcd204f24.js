(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[433],{84308:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/view-notebooks",function(){return t(86369)}])},31143:function(e,n,t){"use strict";var o=t(28598),i=t(1887),c=t.n(i);n.Z=()=>(0,o.jsxs)(c(),{children:[(0,o.jsx)("title",{children:"Defog.ai - AI Assistant for Data Analysis"}),(0,o.jsx)("meta",{name:"description",content:"Train your AI data assistant on your own device"}),(0,o.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,o.jsx)("link",{rel:"icon",href:"/favicon.ico"})]})},62429:function(e,n,t){"use strict";var o=t(28598),i=t(82684),c=t(91568),a=t(79869),s=t(34376);n.Z=e=>{let{id:n,userType:t,children:r}=e,{Content:d,Sider:l}=a.Layout,[u,h]=(0,i.useState)([]),[g,p]=(0,i.useContext)(c._),m=(0,s.useRouter)(),redirect=e=>{m.push(e)},logout=()=>{localStorage.removeItem("defogUser"),localStorage.removeItem("defogToken"),localStorage.removeItem("defogUserType"),p({user:null,token:null,userType:null}),redirect("/log-in")};return(0,i.useEffect)(()=>{h("admin"==t?[{key:"manage-database",title:"Manage Database",icon:(0,o.jsx)("a",{onClick:()=>redirect("/extract-metadata"),children:"\uD83D\uDCBE Manage DB"})},{key:"manage-users",title:"Manage Users",icon:(0,o.jsx)("a",{onClick:()=>redirect("/manage-users"),children:"\uD83D\uDD10 Manage Users"})},{key:"view-notebooks",title:"View your notebook",icon:(0,o.jsx)("a",{onClick:()=>redirect("/view-notebooks"),children:"\uD83D\uDCD2 Your Notebooks"})},{key:"logout",title:"Logout",icon:(0,o.jsx)("a",{onClick:logout,children:"↪ Logout"})}]:t?[{key:"view-notebooks",title:"View your notebook",icon:(0,o.jsx)("a",{onClick:()=>redirect("/view-notebooks"),children:"Your Notebooks"})},{key:"logout",title:"Logout",icon:(0,o.jsx)("a",{onClick:logout,children:"Logout"})}]:[])},[t]),(0,o.jsx)(a.Layout,{style:{height:"100vh"},children:(0,o.jsxs)(d,{children:[u.length?(0,o.jsx)(l,{style:{height:"100vh",position:"fixed"},children:(0,o.jsx)(a.v2,{style:{width:200,paddingTop:"2em",paddingBottom:"2em"},mode:"inline",selectedKeys:[n],items:u})}):(0,o.jsx)(o.Fragment,{}),(0,o.jsx)("div",{style:{paddingLeft:240,paddingTop:30,backgroundColor:"#f5f5f5"},children:r})]})})}},86369:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return view_notebooks}});var o=t(15059),i=t(28598),c=t(82684),a=t(49060),s=t(77652),r=t(12691),d=t.n(r);function _templateObject(){let e=(0,o._)(["\n  width: 200px;\n  margin: 10px;\n  margin-bottom: 2em;\n  position: relative;\n\n  &:hover {\n    .doc-archive-icon {\n      opacity: 1;\n    }\n  }\n\n  .doc-archive-icon {\n    position: absolute;\n    top: -10px;\n    right: -10px;\n    opacity: 0;\n    cursor: pointer;\n    font-size: 15px;\n    padding: 5px;\n    background-color: white;\n    border: 1px solid #949494;\n    border-radius: 50%;\n    height: 30px;\n    width: 30px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    z-index: 4;\n    svg path:not(:first-child) {\n      stroke: #949494;\n    }\n  }\n\n  .doc-icon {\n    border-radius: 8px;\n    width: 100%;\n    height: 150px;\n    display: flex;\n    justify-content: center;\n    align-items: left;\n    background: #a8b1c021;\n    flex-direction: column;\n    padding: 20px;\n\n    &.add-doc {\n      align-items: center;\n      .add-doc-plus {\n        font-size: 3rem;\n        font-weight: bold;\n        color: #a8b1c0c3;\n      }\n    }\n    .stage-icon-label {\n      color: #a8b1c0ff;\n      font-weight: bold;\n      &.done {\n        color: #a8b1c061;\n        text-decoration: line-through;\n        .anticon {\n          margin-left: 4px;\n        }\n      }\n    }\n  }\n  .doc-title {\n    color: #a8b1c0ff;\n    font-weight: bold;\n    margin-top: 1em;\n  }\n  .doc-date {\n    color: #a8b1c0ff;\n    font-weight: bold;\n  }\n"]);return _templateObject=function(){return e},e}function DocIcon(e){var n;let{doc:t,addDocIcon:o=!1,recentlyViewed:c=!1,onClick:a=null}=e;return(0,i.jsxs)(l,{children:[(0,i.jsxs)(d(),{target:"_blank",href:{pathname:"/doc",query:{docId:o?"new":t&&t.doc_id}},children:[(0,i.jsx)("div",{className:"doc-icon "+(o?"add-doc":""),children:o?(0,i.jsx)("p",{className:"add-doc-plus",children:"＋"}):(0,i.jsx)(i.Fragment,{})}),(0,i.jsx)("p",{className:"doc-title",children:o?"New doc":t.doc_title?t.doc_title:"Untitled"}),(0,i.jsxs)("p",{className:"doc-date",children:[c?"Last accessed: ":"",o?"":null==t?void 0:null===(n=t.timestamp)||void 0===n?void 0:n.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})]}),c?(0,i.jsxs)("p",{className:"doc-date",children:["Created by: ",null==t?void 0:t.created_by]}):(0,i.jsx)(i.Fragment,{})]}),o||c?(0,i.jsx)(i.Fragment,{}):(0,i.jsx)("div",{className:"doc-archive-icon",onClick:e=>{!a||"function"!=typeof a||o||c||(e.preventDefault(),a(t))},children:t.archived?(0,i.jsx)(s.IgE,{}):(0,i.jsx)(s.pu4,{})})]})}let l=a.ZP.div.withConfig({componentId:"sc-d648cb6a-0"})(_templateObject());var u=t(91568),h=t(31143),g=t(54186),p=t(18953),m=t(62429),f=t(34376);function view_notebooks_templateObject(){let e=(0,o._)(["\n  .archived-collapse {\n    background-color: transparent;\n    .ant-collapse-content {\n      .ant-collapse-content-box {\n        padding: 0;\n      }\n    }\n  }\n  .doc-icons-container {\n    display: flex;\n    flex-wrap: wrap;\n    justify-content: left;\n    margin: 0 auto;\n    padding: 20px;\n    a {\n      position: relative;\n    }\n  }\n  .header {\n    margin: 20px;\n  }\n"]);return view_notebooks_templateObject=function(){return e},e}let x=a.ZP.div.withConfig({componentId:"sc-54af9072-0"})(view_notebooks_templateObject());var view_notebooks=()=>{let[e,n]=(0,c.useState)(!1),[t,o]=(0,c.useContext)(u._),[a,s]=(0,c.useState)([]),[r,d]=(0,c.useState)([]),[l,v]=(0,c.useState)([]),j=(0,f.useRouter)();async function archiveToggle(e){let n=e.doc_id,t=e.archived,o=l,i=a;t?(o=l.filter(e=>e.doc_id!==n),i=[...a,...l.filter(e=>e.doc_id===n).map(e=>(e.archived=!1,e))]):(o=[...l,...a.filter(e=>e.doc_id===n).map(e=>(e.archived=!0,e))],i=a.filter(e=>e.doc_id!==n)),v(o),s(i);let c=await fetch("http://".concat("DEFOGHOSTNAME","/toggle_archive_status"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doc_id:n,archive_status:!t})});(c=await c.json()).success&&p.default.success("Successfully ".concat(t?"un":"","archived doc")),c.success||p.default.error("Error ".concat(t?"un":"","archiving doc"))}let getNotebooks=async()=>{if(!t.token)return;let e=await fetch("http://".concat("DEFOGHOSTNAME","/get_docs"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({api_key:t.token,username:t.user})});if((e=await e.json()).success){let n=e.docs,o=e.recently_viewed_docs||[];n.forEach(e=>{e.timestamp=new Date(e.timestamp)}),o=o.map(e=>({...e,timestamp:new Date(e.timestamp),created_by:e.username===t.user?"You":e.username})),n.sort((e,n)=>n.timestamp-e.timestamp),d(o),o.sort((e,n)=>n.timestamp-e.timestamp);let i=n.filter(e=>e.archived);n=n.filter(e=>!e.archived),v(i),s(n)}if(!e.success)throw Error(e.error_message);n(!1)};return(0,c.useEffect)(()=>{n(!0);let e=t.token,i=t.userType;if(!i){let n=localStorage.getItem("defogUser");if(e=localStorage.getItem("defogToken"),i=localStorage.getItem("defogUserType"),!n||!e||!i){j.push("/log-in");return}o({user:n,token:e,userType:i})}e?getNotebooks():j.push("/log-in")},[t,t.token]),(0,i.jsxs)(x,{children:[(0,i.jsx)(h.Z,{}),(0,i.jsxs)(m.Z,{id:"view-notebooks",userType:t.userType,children:[(0,i.jsx)("h1",{children:"Notebooks"}),r.length?(0,i.jsx)("h2",{className:"header",children:"Recently viewed"}):null,(0,i.jsx)("div",{className:"doc-icons-container",children:r&&!e?(0,i.jsx)(i.Fragment,{children:r.map(e=>(0,i.jsx)(DocIcon,{doc:e,onClick:archiveToggle,recentlyViewed:!0},e.doc_id))}):(0,i.jsx)("div",{children:"Loading recently viewed docs..."})}),(0,i.jsx)("h2",{className:"header",children:"Your notebooks"}),(0,i.jsx)("div",{className:"doc-icons-container",children:a&&!e?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(DocIcon,{addDocIcon:!0}),a.map(e=>(0,i.jsx)(DocIcon,{doc:e,onClick:archiveToggle},e.doc_id))]}):(0,i.jsx)("div",{children:"Loading docs..."})}),0===l.length?(0,i.jsx)(i.Fragment,{}):(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(g.default,{bordered:!1,size:"small",rootClassName:"archived-collapse",items:[{label:"Archived notebooks",key:"archived-docs",children:(0,i.jsx)("div",{className:"doc-icons-container",children:l.map(e=>(0,i.jsx)(DocIcon,{doc:e,onClick:archiveToggle},e.doc_id))})}]})})]})]})}}},function(e){e.O(0,[391,456,128,287,691,774,888,179],function(){return e(e.s=84308)}),_N_E=e.O()}]);